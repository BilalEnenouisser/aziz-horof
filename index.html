<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø±ÙˆÙ Ù…Ø¹ Ø¹Ø²ÙŠØ² - Ø±Ù…Ø¶Ø§Ù† 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google reCAPTCHA v3 - Will be loaded dynamically if key is configured -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        
        :root {
            --purple: #70429e;
            --red: #e43b40;
            --cyan: #47b7cb;
            --yellow: #f8dc19;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
        }
        
        .ramadan-pattern {
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(112, 66, 158, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(228, 59, 64, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(71, 183, 203, 0.1) 0%, transparent 50%);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #70429e 0%, #e43b40 50%, #47b7cb 100%);
        }
        
        .letter-card {
            transition: all 0.3s ease;
            background: white;
            color: #1f2937;
        }
        
        .letter-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(112, 66, 158, 0.2);
        }
        
        .letter-card label {
            color: #1f2937 !important;
        }
        
        .letter-card input {
            color: #1f2937 !important;
        }
        
        .letter-badge {
            background: linear-gradient(135deg, var(--purple) 0%, var(--cyan) 100%);
        }
        
        .input-focus:focus {
            border-color: var(--purple);
            box-shadow: 0 0 0 3px rgba(112, 66, 158, 0.1);
        }
        
        .select-focus:focus {
            border-color: var(--purple);
            box-shadow: 0 0 0 3px rgba(112, 66, 158, 0.1);
        }
        
        /* Custom Dropdown Styling */
        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M4 6L8 10L12 6' stroke='%2370429e' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 0.75rem center;
            background-size: 1.25rem;
            padding-right: 1rem;
            padding-left: 2.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: white;
        }
        
        select:hover {
            border-color: var(--purple);
            background-color: #faf5ff;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M4 6L8 10L12 6' stroke='%23e43b40' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            box-shadow: 0 2px 8px rgba(112, 66, 158, 0.15);
        }
        
        select:focus {
            border-color: var(--purple);
            background-color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16' fill='none'%3E%3Cpath d='M4 6L8 10L12 6' stroke='%2370429e' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            box-shadow: 0 0 0 3px rgba(112, 66, 158, 0.1);
        }
        
        select option {
            padding: 0.75rem 1rem;
            background-color: white;
            color: #1f2937;
            font-weight: 500;
        }
        
        select option:hover,
        select option:focus {
            background-color: #f3f4f6;
        }
        
        select option:checked {
            background: linear-gradient(135deg, #70429e 0%, #e43b40 100%);
            color: white;
            font-weight: 600;
        }
        
        /* Dropdown wrapper for better styling */
        .select-wrapper {
            position: relative;
        }
        
        .select-wrapper::after {
            content: '';
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            width: 1.25rem;
            height: 1.25rem;
        }
        
        .btn-submit {
            background: linear-gradient(135deg, var(--purple) 0%, var(--red) 100%);
            transition: all 0.3s ease;
        }
        
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(112, 66, 158, 0.4);
        }
        
        .star-decoration {
            animation: twinkle 2s ease-in-out infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }
        
        .crescent {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: -15px 0 0 0 var(--yellow);
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--purple) 0%, var(--cyan) 100%);
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--red) 0%, var(--purple) 100%);
        }
    </style>
</head>
<body class="ramadan-pattern min-h-screen">
    <!-- Banner Section -->
    <div class="relative w-full mb-8 overflow-hidden h-[30vh] md:h-auto">
        <!-- Mobile Banner -->
        <img src="banner-mobile.png" alt="Banner" class="block md:hidden w-full h-full object-cover">
        <!-- Desktop Banner -->
        <img src="banner-desktop.png" alt="Banner" class="hidden md:block w-full h-auto object-cover">
        <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
        <div class="absolute top-4 right-4 floating">
            <img src="logo.png" alt="Logo" class="h-20 w-auto drop-shadow-lg">
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-4 pb-12 relative">
        <!-- Decorative Elements -->
        <div class="absolute top-20 left-10 w-20 h-20 opacity-20 floating">
            <div class="crescent" style="box-shadow: -15px 0 0 0 #f8dc19;"></div>
        </div>
        <div class="absolute top-40 right-20 w-16 h-16 opacity-15 star-decoration">
            <span class="text-6xl text-[#47b7cb]">â­</span>
        </div>
        
        <!-- Header -->
        <div class="text-center mb-10 relative z-10">
            <div class="inline-block mb-4">
                <h1 class="text-5xl md:text-6xl font-bold mb-3 drop-shadow-lg" style="color: #482f6d;">
                    Ø­Ø±ÙˆÙ Ù…Ø¹ Ø¹Ø²ÙŠØ²
                </h1>
                <div class="flex items-center justify-center gap-3 mb-2">
                    <span class="text-3xl star-decoration" style="animation-delay: 0s;">âœ¨</span>
                    <p class="text-xl md:text-2xl font-bold" style="color: #482f6d;">Ø±Ù…Ø¶Ø§Ù† 2026</p>
                    <span class="text-3xl star-decoration" style="animation-delay: 1s;">âœ¨</span>
                </div>
            </div>
            <p class="text-lg text-gray-700 font-semibold">Ø³Ø§Ø¹Ø¯Ù†Ø§ ÙÙŠ Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø§Ù„Ù…Ù…ÙŠØ²Ø©</p>
        </div>

        <!-- Form -->
        <form id="helpForm" class="bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-6 md:p-10 border-2 border-[#70429e]/20">
            <!-- Question Forms Section -->
            <div id="questionFormsContainer" class="mb-6">
                <div class="mb-6 p-4 rounded-xl gradient-bg text-white">
                    <h3 class="text-2xl font-bold mb-2 text-right flex items-center gap-2">
                        <span>âœ¨</span>
                        <span>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø©</span>
                    </h3>
                </div>
                
                <!-- Question Forms Container -->
                <div id="questionsContainer" class="space-y-6">
                    <!-- First Question Form -->
                    <div class="question-form-block bg-white p-6 rounded-xl border-2 border-gray-100 shadow-sm">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <!-- Category -->
                            <div>
                                <label class="block text-right text-gray-800 font-bold mb-2 text-lg">
                                    Ù…Ø¬Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ <span class="text-[#e43b40]">*</span>
                                </label>
                                <select name="questionCategory" required
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl select-focus text-right bg-white text-gray-800 font-medium transition-all cursor-pointer text-sm question-category">
                                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¬Ø§Ù„ --</option>
                                    <option value="Ø±ÙŠØ§Ø¶Ø©">Ø±ÙŠØ§Ø¶Ø©</option>
                                    <option value="Ø«Ù‚Ø§ÙØ©">Ø«Ù‚Ø§ÙØ©</option>
                                    <option value="ÙÙ†">ÙÙ†</option>
                                    <option value="ØªØ§Ø±ÙŠØ®">ØªØ§Ø±ÙŠØ®</option>
                                    <option value="Ø¬ØºØ±Ø§ÙÙŠØ§">Ø¬ØºØ±Ø§ÙÙŠØ§</option>
                                    <option value="Ø¯ÙŠÙ†">Ø¯ÙŠÙ†</option>
                                    <option value="Ø§Ù„ØºØ§Ø²">Ø§Ù„ØºØ§Ø²</option>
                                    <option value="Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø«Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆÙ…Ø¹Ù†Ø§Ù‡Ø§ Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙÙ‡Ø§ ÙˆØ§Ù„ÙƒÙ„Ù…Ø© ÙˆØ¹ÙƒØ³Ù‡Ø§">Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø«Ù„ Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆÙ…Ø¹Ù†Ø§Ù‡Ø§ Ø£Ùˆ Ù…Ø±Ø§Ø¯ÙÙ‡Ø§ ÙˆØ§Ù„ÙƒÙ„Ù…Ø© ÙˆØ¹ÙƒØ³Ù‡Ø§</option>
                                    <option value="Ø§Ø¯Ø¨ Ùˆ Ø´Ø¹Ø±">Ø§Ø¯Ø¨ Ùˆ Ø´Ø¹Ø±</option>
                                    <option value="Ø§Ù…Ø«Ø§Ù„">Ø§Ù…Ø«Ø§Ù„</option>
                                    <option value="Ø·Ø¨">Ø·Ø¨</option>
                                    <option value="Ø¹Ù„ÙˆÙ…">Ø¹Ù„ÙˆÙ…</option>
                                    <option value="Ù‚Ø±Ø§Ù†">Ù‚Ø±Ø§Ù†</option>
                                    <option value="Ø´Ø®ØµÙŠØ§Øª Ù…Ø´Ù‡ÙˆØ±Ø© Ø¹Ø±Ø¨ÙŠØ©">Ø´Ø®ØµÙŠØ§Øª Ù…Ø´Ù‡ÙˆØ±Ø© Ø¹Ø±Ø¨ÙŠØ©</option>
                                    <option value="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø§Ù…Ø©</option>
                                    <option value="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
                                    <option value="ÙˆØ·Ù†ÙŠØ©">ÙˆØ·Ù†ÙŠØ©</option>
                                    <option value="ØªØ§Ø±ÙŠØ® Ø§Ø³Ù„Ø§Ù…ÙŠ">ØªØ§Ø±ÙŠØ® Ø§Ø³Ù„Ø§Ù…ÙŠ</option>
                                    <option value="Ø§Ù„Ø§Ù†Ø¨ÙŠØ§Ø¡ Ùˆ Ø§Ù„ØµØ­Ø§Ø¨Ø©">Ø§Ù„Ø§Ù†Ø¨ÙŠØ§Ø¡ Ùˆ Ø§Ù„ØµØ­Ø§Ø¨Ø©</option>
                                    <option value="Ø¹ÙˆØ§ØµÙ… ÙˆØ¯ÙˆÙ„">Ø¹ÙˆØ§ØµÙ… ÙˆØ¯ÙˆÙ„</option>
                                    <option value="Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª">Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</option>
                                    <option value="Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©">Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©</option>
                                    <option value="Ø§Ù„ØªÙ‚Ù†ÙŠØ©">Ø§Ù„ØªÙ‚Ù†ÙŠØ©</option>
                                </select>
                            </div>

                            <!-- Question -->
                            <div>
                                <label class="block text-right text-gray-800 font-bold mb-2 text-lg">
                                    Ø§Ù„Ø³Ø¤Ø§Ù„ <span class="text-[#e43b40]">*</span>
                                </label>
                                <input type="text" name="question" required
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl input-focus text-right text-gray-800 placeholder-gray-400 transition-all text-sm"
                                    placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„">
                            </div>

                            <!-- Letter -->
                            <div>
                                <label class="block text-right text-gray-800 font-bold mb-2 text-lg">
                                    Ø§Ù„Ø­Ø±Ù <span class="text-[#e43b40]">*</span>
                                </label>
                                <select name="letter" required
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl select-focus text-right bg-white text-gray-800 font-medium transition-all cursor-pointer text-sm question-letter">
                                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø­Ø±Ù --</option>
                                </select>
                            </div>

                            <!-- Answer -->
                            <div>
                                <label class="block text-right text-gray-800 font-bold mb-2 text-lg">
                                    Ø§Ù„Ø§Ø¬Ø§Ø¨Ø© <span class="text-[#e43b40]">*</span>
                                </label>
                                <input type="text" name="answer" required
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl input-focus text-right text-gray-800 placeholder-gray-400 transition-all text-sm"
                                    placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Question Button -->
                <div class="mt-4">
                    <button type="button" id="addQuestionBtn" class="w-full bg-[#47b7cb] hover:bg-[#3aa5b8] text-white font-bold py-3 px-6 rounded-xl transition duration-200 shadow-lg hover:shadow-xl">
                        Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¢Ø®Ø±
                    </button>
                </div>
            </div>


            <!-- Submit Button -->
            <div class="mt-10">
                <button type="submit" id="submitBtn"
                    class="w-full btn-submit text-white font-bold py-5 px-8 rounded-xl text-xl shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                    <span class="flex items-center justify-center gap-2">
                        <span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span>
                        <span>ğŸš€</span>
                    </span>
                </button>
                <!-- reCAPTCHA v3 Badge (appears automatically in bottom-right corner) -->
                <div class="mt-4 text-center text-sm text-gray-600">
                    <p>ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© reCAPTCHA</p>
                </div>
            </div>
        </form>
    </div>

    <!-- Thank You Popup -->
    <div id="thankYouPopup" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md mx-4 text-center relative overflow-hidden">
            <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-[#70429e]/10 to-[#47b7cb]/10 rounded-full -mr-16 -mt-16"></div>
            <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-[#e43b40]/10 to-[#f8dc19]/10 rounded-full -ml-12 -mb-12"></div>
            <div class="relative z-10">
                <div class="mb-6">
                    <div class="mx-auto w-20 h-20 rounded-full gradient-bg flex items-center justify-center mb-4 shadow-lg">
                        <svg class="h-12 w-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                </div>
                <h2 class="text-3xl font-bold mb-4" style="color: #482f6d;">Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ! âœ¨</h2>
                <p class="text-gray-700 mb-4 text-lg leading-relaxed">Ù†Ø´ÙƒØ±Ùƒ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø¥Ø«Ø±Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰. ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­.</p>
                <p id="remainingSubmissionsText" class="text-[#70429e] font-bold text-xl mb-8 hidden"></p>
                <button onclick="closeThankYouPopup()" class="btn-submit text-white font-bold py-3 px-8 rounded-xl transition duration-200 shadow-lg hover:shadow-xl">
                    Ù…ÙˆØ§ÙÙ‚
                </button>
            </div>
        </div>
    </div>

    <!-- Validation Error Popup -->
    <div id="validationPopup" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md mx-4 text-center relative overflow-hidden">
            <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-[#e43b40]/10 to-[#70429e]/10 rounded-full -mr-16 -mt-16"></div>
            <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-[#e43b40]/10 to-[#f8dc19]/10 rounded-full -ml-12 -mb-12"></div>
            <div class="relative z-10">
                <div class="mb-6">
                    <div class="mx-auto w-20 h-20 rounded-full bg-red-500 flex items-center justify-center mb-4 shadow-lg">
                        <svg class="h-12 w-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </div>
                </div>
                <h2 class="text-3xl font-bold mb-4" style="color: #e43b40;">ØªÙ†Ø¨ÙŠÙ‡! âš ï¸</h2>
                <p id="validationMessage" class="text-gray-700 mb-8 text-lg leading-relaxed">ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</p>
                <button onclick="closeValidationPopup()" class="bg-[#e43b40] hover:bg-[#d32f2f] text-white font-bold py-3 px-8 rounded-xl transition duration-200 shadow-lg hover:shadow-xl">
                    Ù…ÙˆØ§ÙÙ‚
                </button>
            </div>
        </div>
    </div>

    <script>
        // Arabic letters with their names
        const arabicLetters = [
            { name: "Ø£Ù„Ù", letter: "Ø£" },
            { name: "Ø¨Ø§Ø¡", letter: "Ø¨" },
            { name: "ØªØ§Ø¡", letter: "Øª" },
            { name: "Ø«Ø§Ø¡", letter: "Ø«" },
            { name: "Ø¬ÙŠÙ…", letter: "Ø¬" },
            { name: "Ø­Ø§Ø¡", letter: "Ø­" },
            { name: "Ø®Ø§Ø¡", letter: "Ø®" },
            { name: "Ø¯Ø§Ù„", letter: "Ø¯" },
            { name: "Ø°Ø§Ù„", letter: "Ø°" },
            { name: "Ø±Ø§Ø¡", letter: "Ø±" },
            { name: "Ø²Ø§ÙŠ", letter: "Ø²" },
            { name: "Ø³ÙŠÙ†", letter: "Ø³" },
            { name: "Ø´ÙŠÙ†", letter: "Ø´" },
            { name: "ØµØ§Ø¯", letter: "Øµ" },
            { name: "Ø¶Ø§Ø¯", letter: "Ø¶" },
            { name: "Ø·Ø§Ø¡", letter: "Ø·" },
            { name: "Ø¸Ø§Ø¡", letter: "Ø¸" },
            { name: "Ø¹ÙŠÙ†", letter: "Ø¹" },
            { name: "ØºÙŠÙ†", letter: "Øº" },
            { name: "ÙØ§Ø¡", letter: "Ù" },
            { name: "Ù‚Ø§Ù", letter: "Ù‚" },
            { name: "ÙƒØ§Ù", letter: "Ùƒ" },
            { name: "Ù„Ø§Ù…", letter: "Ù„" },
            { name: "Ù…ÙŠÙ…", letter: "Ù…" },
            { name: "Ù†ÙˆÙ†", letter: "Ù†" },
            { name: "Ù‡Ø§Ø¡", letter: "Ù‡Ù€" },
            { name: "ÙˆØ§Ùˆ", letter: "Ùˆ" },
            { name: "ÙŠØ§Ø¡", letter: "ÙŠ" }
        ];

        const questionsContainer = document.getElementById('questionsContainer');
        const addQuestionBtn = document.getElementById('addQuestionBtn');

        // Google Sheets Web App URL - Replace with your URL after setting up Google Apps Script
        // Get this URL from: Google Sheets â†’ Extensions â†’ Apps Script â†’ Deploy â†’ Web app
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyHy_9inhTMovysZE_0cQNrjmeYAlUrgu5aWR9twaxBChgoNllzdIzwqaIAMbqpQBdn/exec'; // Paste your Google Apps Script Web App URL here

        // reCAPTCHA Configuration
        const RECAPTCHA_SITE_KEY = '6LdQeSQsAAAAAMHDcnWDpm1Pb3sKTdWVfreDjDkm'; // Your reCAPTCHA Site Key
        const RECAPTCHA_VERSION = 'v3'; // This key is for reCAPTCHA v3
        let recaptchaWidgetId = null;

        // Load reCAPTCHA if key is configured
        if (RECAPTCHA_SITE_KEY && RECAPTCHA_SITE_KEY !== 'YOUR_RECAPTCHA_SITE_KEY') {
            const script = document.createElement('script');
            if (RECAPTCHA_VERSION === 'v3') {
                // reCAPTCHA v3
                script.src = `https://www.google.com/recaptcha/api.js?render=${RECAPTCHA_SITE_KEY}`;
            } else {
                // reCAPTCHA v2 Invisible
                script.src = 'https://www.google.com/recaptcha/api.js?render=explicit';
            }
            script.async = true;
            script.defer = true;
            document.head.appendChild(script);
            
            // reCAPTCHA v3 doesn't need widget initialization - it runs automatically
            // The badge will appear automatically in the bottom-right corner
        }

        // Rate Limiting Configuration
        const RATE_LIMIT_CONFIG = {
            maxSubmissions: 5, // Maximum submissions per hour
            blockDuration: 6 * 60 * 60 * 1000 // 6 hours in milliseconds
        };

        // Rate Limiting Functions
        function getStorageKey(key) {
            return `aziz_horof_${key}`;
        }

        function isUserBlocked() {
            const blockData = localStorage.getItem(getStorageKey('blocked'));
            if (!blockData) return false;
            
            const { timestamp, reason } = JSON.parse(blockData);
            const now = Date.now();
            const timeElapsed = now - timestamp;
            
            if (timeElapsed < RATE_LIMIT_CONFIG.blockDuration) {
                const remainingMs = RATE_LIMIT_CONFIG.blockDuration - timeElapsed;
                const remainingHours = Math.floor(remainingMs / (60 * 60 * 1000));
                const remainingMinutes = Math.floor((remainingMs % (60 * 60 * 1000)) / (60 * 1000));
                
                let remainingTimeText = '';
                if (remainingHours > 0) {
                    remainingTimeText = `${remainingHours} Ø³Ø§Ø¹Ø©`;
                    if (remainingMinutes > 0) {
                        remainingTimeText += ` Ùˆ ${remainingMinutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
                    }
                } else {
                    remainingTimeText = `${remainingMinutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
                }
                
                return {
                    blocked: true,
                    reason: reason,
                    remainingTime: remainingTimeText,
                    remainingHours: remainingHours
                };
            } else {
                // Block expired, remove it
                localStorage.removeItem(getStorageKey('blocked'));
                return false;
            }
        }

        function blockUser(reason) {
            const blockData = {
                timestamp: Date.now(),
                reason: reason
            };
            localStorage.setItem(getStorageKey('blocked'), JSON.stringify(blockData));
        }

        function checkRateLimit() {
            const submissions = JSON.parse(localStorage.getItem(getStorageKey('submissions')) || '[]');
            const now = Date.now();
            
            // Remove old submissions (older than 1 hour)
            const oneHourAgo = now - (60 * 60 * 1000);
            const recentSubmissions = submissions.filter(time => time > oneHourAgo);
            
            // Check if too many submissions
            if (recentSubmissions.length >= RATE_LIMIT_CONFIG.maxSubmissions) {
                blockUser('Too many submissions in short time');
                const blockStatus = isUserBlocked();
                return {
                    allowed: false,
                    reason: `ØªÙ… Ø­Ø¸Ø±Ùƒ Ø¨Ø³Ø¨Ø¨ ÙƒØ«Ø±Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${blockStatus.remainingTime} Ø³Ø§Ø¹Ø©.`
                };
            }
            
            // Calculate remaining submissions BEFORE adding current
            const remainingBefore = RATE_LIMIT_CONFIG.maxSubmissions - recentSubmissions.length;
            
            // Update submissions list
            recentSubmissions.push(now);
            localStorage.setItem(getStorageKey('submissions'), JSON.stringify(recentSubmissions));
            
            // Calculate remaining AFTER adding current submission
            const remainingAfter = remainingBefore - 1;
            
            return { 
                allowed: true,
                remainingSubmissions: remainingAfter >= 0 ? remainingAfter : 0
            };
        }

        // Check if user is blocked on page load
        window.addEventListener('load', function() {
            const blockStatus = isUserBlocked();
            if (blockStatus) {
                const submitBtn = document.getElementById('submitBtn');
                if (submitBtn) {
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = `<span class="flex items-center justify-center gap-2"><span>ØªÙ… Ø­Ø¸Ø±Ùƒ - Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${blockStatus.remainingTime}</span><span>ğŸš«</span></span>`;
                }
            }
        });

        // Function to populate letter dropdown
        function populateLetterDropdown(selectElement) {
            // Clear existing options except the first one
            while (selectElement.options.length > 1) {
                selectElement.remove(1);
            }
            // Add letter options
            arabicLetters.forEach((item) => {
                const option = document.createElement('option');
                option.value = item.letter;
                option.textContent = `${item.name} (${item.letter})`;
                selectElement.appendChild(option);
            });
        }

        // Populate letter dropdowns on page load
        function initializeLetterDropdowns() {
            const letterSelects = document.querySelectorAll('.question-letter');
            letterSelects.forEach(select => {
                populateLetterDropdown(select);
            });
        }

        // Initialize on page load
        initializeLetterDropdowns();

        // Function to validate if a form is completely filled
        function isFormFilled(form) {
            const category = form.querySelector('select[name="questionCategory"]').value.trim();
            const question = form.querySelector('input[name="question"]').value.trim();
            const letter = form.querySelector('select[name="letter"]').value.trim();
            const answer = form.querySelector('input[name="answer"]').value.trim();
            
            return category && question && letter && answer;
        }

        // Add new question form
        addQuestionBtn.addEventListener('click', function() {
            // Get all existing question forms
            const existingForms = document.querySelectorAll('.question-form-block');
            
            // Validate all existing forms are filled
            for (let i = 0; i < existingForms.length; i++) {
                if (!isFormFilled(existingForms[i])) {
                    // Show validation popup
                    showValidationPopup('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯');
                    // Scroll to the incomplete form
                    existingForms[i].scrollIntoView({ behavior: 'smooth', block: 'center' });
                    // Highlight the incomplete form
                    existingForms[i].style.borderColor = '#e43b40';
                    existingForms[i].style.boxShadow = '0 0 0 3px rgba(228, 59, 64, 0.2)';
                    setTimeout(() => {
                        existingForms[i].style.borderColor = '';
                        existingForms[i].style.boxShadow = '';
                    }, 2000);
                    return;
                }
            }

            // Get the first question form as template
            const firstForm = document.querySelector('.question-form-block');
            if (!firstForm) return;

            // Clone the form
            const newForm = firstForm.cloneNode(true);
            
            // Remove any existing remove button from the clone
            const existingRemoveBtn = newForm.querySelector('button[type="button"]');
            if (existingRemoveBtn && existingRemoveBtn.textContent.includes('Ø­Ø°Ù')) {
                existingRemoveBtn.remove();
            }
            
            // Clear all input values in the new form
            const inputs = newForm.querySelectorAll('input[type="text"]');
            inputs.forEach(input => input.value = '');
            
            const selects = newForm.querySelectorAll('select');
            selects.forEach(select => {
                select.value = '';
                // Repopulate letter dropdown if it's a letter select
                if (select.classList.contains('question-letter')) {
                    populateLetterDropdown(select);
                }
            });

            // Add remove button to the new form
            const removeBtn = document.createElement('button');
            removeBtn.type = 'button';
            removeBtn.className = 'mt-4 w-full bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition duration-200';
            removeBtn.textContent = 'Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„';
            removeBtn.onclick = function() {
                newForm.remove();
            };
            newForm.appendChild(removeBtn);

            // Append to container
            questionsContainer.appendChild(newForm);
            
            // Re-populate letter dropdown in the new form
            const newLetterSelect = newForm.querySelector('.question-letter');
            if (newLetterSelect) {
                populateLetterDropdown(newLetterSelect);
            }
        });

        // Form submission
        document.getElementById('helpForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Check if user is blocked
            const blockStatus = isUserBlocked();
            if (blockStatus) {
                showValidationPopup(`ØªÙ… Ø­Ø¸Ø±Ùƒ! Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${blockStatus.remainingTime}`);
                return;
            }
            
            // Check rate limit
            const rateLimitCheck = checkRateLimit();
            if (!rateLimitCheck.allowed) {
                showValidationPopup(rateLimitCheck.reason);
                return;
            }
            
            // Get remaining submissions
            const remainingSubmissions = rateLimitCheck.remainingSubmissions || 0;
            
            // Collect all questions from all forms
            const questionForms = document.querySelectorAll('.question-form-block');
            const questions = [];
            let hasErrors = false;

            questionForms.forEach((form, index) => {
                const category = form.querySelector('select[name="questionCategory"]').value;
                const question = form.querySelector('input[name="question"]').value;
                const letter = form.querySelector('select[name="letter"]').value;
                const answer = form.querySelector('input[name="answer"]').value;

                // Validate required fields
                if (!category || !question || !letter || !answer) {
                    hasErrors = true;
                    return;
                }

                questions.push({
                    category: category,
                    question: question,
                    letter: letter,
                    answer: answer
                });
            });

            // Check if at least one question is added
            if (questions.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ ÙˆÙ…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }

            // Check for validation errors
            if (hasErrors) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©');
                return;
            }
            
            // Collect form data
            const formData = {
                questions: questions
            };

            // Log data
            console.log('Form Data:', formData);
            
            // Disable submit button during submission
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</span><span>â³</span></span>';
            
            // Verify reCAPTCHA (if configured)
            if (RECAPTCHA_SITE_KEY && RECAPTCHA_SITE_KEY !== 'YOUR_RECAPTCHA_SITE_KEY') {
                grecaptcha.ready(function() {
                    if (RECAPTCHA_VERSION === 'v3') {
                        // reCAPTCHA v3
                        grecaptcha.execute(RECAPTCHA_SITE_KEY, {action: 'submit'}).then(function(token) {
                            // Add token to form data
                            formData.recaptchaToken = token;
                            submitFormData(formData, submitBtn, remainingSubmissions);
                        }).catch(function(error) {
                            console.error('reCAPTCHA v3 error:', error);
                            showValidationPopup('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù‚Ù‚. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span><span>ğŸš€</span></span>';
                        });
                    } else {
                        // reCAPTCHA v2 Checkbox (visible)
                        if (recaptchaWidgetId !== null) {
                            // Get the response token from the checkbox
                            const token = grecaptcha.getResponse(recaptchaWidgetId);
                            
                            if (!token) {
                                // User hasn't checked the CAPTCHA box
                                showValidationPopup('ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ†Ø¯ÙˆÙ‚ reCAPTCHA Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„');
                                submitBtn.disabled = false;
                                submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span><span>ğŸš€</span></span>';
                                return;
                            }
                            
                            // Add token to form data
                            formData.recaptchaToken = token;
                            submitFormData(formData, submitBtn, remainingSubmissions);
                        } else {
                            // Widget not initialized yet
                            showValidationPopup('Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ reCAPTCHA. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span><span>ğŸš€</span></span>';
                        }
                    }
                });
            } else {
                // No CAPTCHA configured, proceed directly
                submitFormData(formData, submitBtn, remainingSubmissions);
            }
        });

        // Function to submit form data
        function submitFormData(formData, submitBtn, remainingSubmissions = 0) {
            submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...</span><span>â³</span></span>';
            
            // Send data to Google Sheets (if URL is configured)
            if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL.trim() !== '') {
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Required for Google Apps Script
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                })
                .then(() => {
                    // Success - show popup with remaining submissions
                    showThankYouPopup(remainingSubmissions);
                    resetForm();
                })
                .catch((error) => {
                    // Error handling
                    console.error('Error:', error);
                    // Still show success popup (no-cors mode doesn't return response)
                    // In production, you might want to show an error popup
                    showThankYouPopup(remainingSubmissions);
                    resetForm();
                })
                .finally(() => {
                    // Re-enable submit button
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span><span>ğŸš€</span></span>';
                });
            } else {
                // No Google Sheets URL configured - just show popup
                console.warn('Google Sheets URL not configured. Data not saved.');
                showThankYouPopup(remainingSubmissions);
                resetForm();
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<span class="flex items-center justify-center gap-2"><span>Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©</span><span>ğŸš€</span></span>';
            }
        }

        function resetForm() {
            // Reset form
            document.getElementById('helpForm').reset();
            // Reset all question forms to first one
            const questionForms = document.querySelectorAll('.question-form-block');
            if (questionForms.length > 0) {
                const firstForm = questionForms[0];
                questionsContainer.innerHTML = '';
                questionsContainer.appendChild(firstForm);
                // Clear first form
                firstForm.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
                firstForm.querySelectorAll('select').forEach(select => select.value = '');
                // Re-initialize letter dropdowns
                initializeLetterDropdowns();
            }
            // Reset reCAPTCHA (only for v2, v3 doesn't need reset)
            if (RECAPTCHA_VERSION === 'v2' && recaptchaWidgetId !== null && typeof grecaptcha !== 'undefined') {
                grecaptcha.reset(recaptchaWidgetId);
            }
        }

        function showThankYouPopup(remainingSubmissions = 0) {
            const remainingText = document.getElementById('remainingSubmissionsText');
            if (remainingSubmissions > 0) {
                remainingText.textContent = `Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© Ø§Ù„ÙŠÙˆÙ…: ${remainingSubmissions}`;
                remainingText.classList.remove('hidden');
            } else if (remainingSubmissions === 0) {
                remainingText.textContent = 'Ù„Ù‚Ø¯ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…';
                remainingText.classList.remove('hidden');
            } else {
                remainingText.classList.add('hidden');
            }
            document.getElementById('thankYouPopup').classList.remove('hidden');
        }

        function closeThankYouPopup() {
            document.getElementById('thankYouPopup').classList.add('hidden');
        }

        function showValidationPopup(message) {
            const validationMessage = document.getElementById('validationMessage');
            if (validationMessage) {
                validationMessage.textContent = message;
            }
            document.getElementById('validationPopup').classList.remove('hidden');
        }

        function closeValidationPopup() {
            document.getElementById('validationPopup').classList.add('hidden');
        }

        // Close popups when clicking outside
        document.getElementById('thankYouPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closeThankYouPopup();
            }
        });

        document.getElementById('validationPopup').addEventListener('click', function(e) {
            if (e.target === this) {
                closeValidationPopup();
            }
        });
    </script>
</body>
</html>
